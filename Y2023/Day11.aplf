 Day11←{
     ⎕IO←1
     map←↑snl ⍵
     xc←⍸~∨⌿'#'=map
     xr←⍸~∨/'#'=map

     i←⍳+/,'#'=map
     Dist←{
         y←⊃¨⍺ ⍵
         ay←(⍺⍺-1)×+/1=(∆ y)⍸xr
         x←⊃∘⌽¨⍺ ⍵
         ax←(⍺⍺-1)×+/1=(∆ x)⍸xc
         +/ay ax+|⍵-⍺
     }
 ⍝    p1←+/,(∘.≤⍨⍳≢i)×∘.(1 Dist)⍨⍸'#'=map

     n←1e6
     idx←⍸'#'=map
     (y x)←↓⍉↑idx
     ax←(n-1)×+/¨1=(∆¨∘.,⍨x)⍸¨⊂xc
     ay←(n-1)×+/¨1=(∆¨∘.,⍨y)⍸¨⊂xr
     d←∘.-⍨idx
     +/,(∘.≤⍨⍳≢idx)×+/¨(ax,¨ay)+|d
     +/,(∘.≤⍨⍳≢i)×∘.(1000000 Dist)⍨⍸'#'=map
 }
